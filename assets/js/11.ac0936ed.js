(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{291:function(s,n,a){"use strict";a.r(n);var t=a(0),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[s._v("虚拟化是什么")]),s._v(" "),a("p",[s._v("通过软件模拟的具有完整硬件系统功能的、运行在一个完全隔离环境中的完整计算机系统。在实体计算机中能够完成的工作在虚拟机中都能够实现")])]),s._v(" "),a("h2",{attrs:{id:"docker-原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-原理","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker 原理")]),s._v(" "),a("p",[s._v("容器有效的将单个操作系统管理的资源划分到孤立的组中，以便更好的在孤立的组之间平衡有冲突的资源使用需求。与虚拟化相比，这样既不需要指令级模拟，也不需要即时编译。容器可以在核心CPU本地运行指令，而不需要任何专门的解释机制。此外，也避免了准虚拟化（paravirtualization）和系统调用替换中的复杂性。\n简而言之就是，Docker是一个盒子，一个盒子装一个玩具，无论你丢在哪里，你给他通电(glibc)，他就能运行。你的玩具大就用大盒子，小玩具就用小盒子。")]),s._v(" "),a("p",[s._v("两个应用之间的环境是环境是完全隔离的，建立通信机制来互相调用。容器的创建和停止都十分快速（秒级），容器自身对资源的需求十分有限，远比虚拟机本身占用的资源少。")]),s._v(" "),a("h2",{attrs:{id:"docker-对比-传统虚拟化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-对比-传统虚拟化","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker 对比 传统虚拟化")]),s._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[a("img",{attrs:{src:"https://took-up-up.gitee.io/pic/vm.png",alt:""}}),s._v(" "),a("img",{attrs:{src:"https://took-up-up.gitee.io/pic/docker.png",alt:""}})]),s._v(" "),a("ol",[a("li",[s._v("与宿主机使用同一个内核，性能损耗小；")]),s._v(" "),a("li",[s._v("不需要指令级模拟；")]),s._v(" "),a("li",[s._v("不需要即时(Just-in-time)编译；")]),s._v(" "),a("li",[s._v("容器可以在CPU核心的本地运行指令，不需要任何专门的解释机制；")]),s._v(" "),a("li",[s._v("避免了准虚拟化和系统调用替换中的复杂性；")]),s._v(" "),a("li",[s._v("轻量级隔离，在隔离的同时还提供共享机制，以实现容器与宿主机的资源共享。\n总结: 传统虚拟化提供系统环境,容器提供应用环境,虚拟化层次不同")])])]),s._v(" "),a("h2",{attrs:{id:"docker-架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-架构","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker 架构")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://took-up-up.gitee.io/pic/docker1.png",alt:""}}),s._v("\nDocker 使用客户端-服务器 (C/S) 架构模式，使用远程API来管理和创建Docker容器")]),s._v(" "),a("p",[s._v("Docker 容器通过 Docker 镜像来创建。")]),s._v(" "),a("h2",{attrs:{id:"docker-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-install","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker Install")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils device-mapper-persistent-data lvm2\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖")]),s._v("\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置镜像源")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y docker-ce\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 Docker-CE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器镜像缺省路径/var/lib/docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"docker-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-config","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker Config")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置开机启动")]),s._v("\nsystemctl start docker\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" docker "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" xx\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -aG docker xx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加docker用户组（可选）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n    "registry-mirrors": ["http://hub-mirror.c.163.com"]\n}\nEOF')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置加速镜像(文件没有即创建)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n    "registry-mirrors": [\n            "http://hub-mirror.c.163.com",\n            "registry-scu.cloudtogo.cn",\n            ],\n    "insecure-registry": ["x.x.x.x:5000"]\n}\nEOF')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置多个加速镜像和私有库地址")]),s._v("\nsystemctl daemon-reload\nsystemctl restart docker\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("h2",{attrs:{id:"错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#错误","aria-hidden":"true"}},[s._v("#")]),s._v(" 错误")]),s._v(" "),a("p",[s._v("/usr/bin/docker-current:\nError response from daemon:\nerror creating overlay mount to\n/var/lib/docker/overlay2/65f3c109fb903539820f84856d2725af784f2f03f95b1f0214e34184e4d61ff7-init/merged:\ninvalid argument.")]),s._v(" "),a("p",[s._v("解决方案")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl stop docker\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/docker\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/sysconfig/docker-storage\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改存储类型")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DOCKER_STORAGE_OPTIONS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--storage-driver overlay"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 并且去除")]),s._v("\n--selinux-enabled\nsystemctl start docker\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"use"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#use","aria-hidden":"true"}},[s._v("#")]),s._v(" Use")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker pull ubuntu:15.10\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拉取镜像")]),s._v("\ndocker run -it ubuntu:15.10 /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动镜像 i: 交互式操作 t: 终端 d: 后台启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在完成操作之后，输入 exit 命令来退出这个容器")]),s._v("\ndocker images\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有镜像")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有容器")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有已停止运行的容器")]),s._v("\ndocker stop 容器ID\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止一个容器")]),s._v("\ndocker restart 容器ID\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动一个容器")]),s._v("\ndocker "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it 容器ID /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入一个运行在后台的容器")]),s._v("\ndocker attach 容器ID\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与exec相同,但退出后会停止容器")]),s._v("\n\n\n\ndocker run -d -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 -v "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PWD")]),s._v("/html:usr/share/nginx/html docker.io/nginx --name nginx\ndocker run -d -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 -v ~/nginx/www:/usr/share/nginx/html -v ~/nginx/conf/nginx.conf:/etc/nginx/nginx.conf -v ~/nginx/logs:/var/log/nginx nginx\n\n\ndocker commit -m"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"has update"')]),s._v(" -a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"runoob"')]),s._v(" e218edb10161 runoob/ubuntu:v2\n-m:提交的描述信息\n-a:指定镜像作者\ne218edb10161：容器ID\nrunoob/ubuntu:v2:指定要创建的目标镜像名\n\ndocker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 6dd4380ba708:/etc/nginx/nginx.conf ~/nginx/conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("h2",{attrs:{id:"docker-安装ubuntu"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装ubuntu","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker 安装Ubuntu")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker pull dorowu/ubuntu-desktop-lxde-vnc\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拉取镜像")]),s._v("\ndocker run -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6080")]),s._v(":80 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5900")]),s._v(":5900 -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VNC_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("VNC登录的密码 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("RESOLUTION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1920x1080 -v /dev/shm:/dev/shm dorowu/ubuntu-desktop-lxde-vnc\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行容器 6080为web版本vnc")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"ex"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ex","aria-hidden":"true"}},[s._v("#")]),s._v(" ex")])])}),[],!1,null,null,null);n.default=e.exports}}]);