(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{299:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[s._v("介绍")]),s._v(" "),t("ol",[t("li",[s._v("这是一个例子；"),t("br"),s._v("\n2.. 你可以打开 "),t("a",{attrs:{href:"ex"}},[s._v("ex")])])])]),s._v(" "),t("h2",{attrs:{id:"server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#server","aria-hidden":"true"}},[s._v("#")]),s._v(" Server")]),s._v(" "),t("h3",{attrs:{id:"install"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install","aria-hidden":"true"}},[s._v("#")]),s._v(" Install")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh https://mirrors.tuna.tsinghua.edu.cn/epel/epel-release-latest-7.noarch.rpm\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装yum源")]),s._v("\nyum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" salt-master\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 saltstack")]),s._v("\nsystemctl start salt-master\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 saltstack server 默认端口 4505, 4506")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"authorized"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#authorized","aria-hidden":"true"}},[s._v("#")]),s._v(" Authorized")]),s._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",[s._v("minion在第一次启动时，会在/etc/salt/pki/minion/（该路径在/etc/salt/minion里\n面设置）下自动生成minion.pem（private key）和 minion.pub（public key），然>后将 minion.pub发送给master。master在接收到minion的public key后，通过salt-key命令accept minion public key，这样在master的/etc/salt/pki/master/minions>下的将会存放以minion id命名的 public key，然后master就能对minion发送指令了>。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("salt-key -L\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看当前证书签证情况")]),s._v("\nsalt-key -A -y\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同意签证所有没有接受的签证情况")]),s._v("\nsalt-key -a\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定id")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"config"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#config","aria-hidden":"true"}},[s._v("#")]),s._v(" Config")]),s._v(" "),t("p",[s._v("vim /etc/salt/master")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("file_roots:\n   base:\n     - /srv/salt/bass\n   dev:\n     - /srv/salt/dev\n   prod:\n     - /srv/salt/prod\n   test:\n     - /srv/salt/test\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("systemctl restart salt-master\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启 server")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"use"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#use","aria-hidden":"true"}},[s._v("#")]),s._v(" Use")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" test.ping\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对所有主机进行连通性测试")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" cmd.run "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls -al'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对所有主机发送 ls -al 命令")]),s._v("\n\nsalt -E "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root*'")]),s._v(" test.ping\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主机名以root开头")]),s._v("\nsalt -L root1,root2 test.ping\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列表匹配")]),s._v("\nalt -G "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'os:CentOS'")]),s._v(" test.ping\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Grians匹配")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# os:CentOS（默认存在）是Grains的键值对，数据以yaml保存在minion上，可在minion端直接编辑/etc/salt/grains，yaml格式。或者在master端执行salt '*' grains.setval key \"{'sub-key': 'val', 'sub-key2': 'val2'}\" ,具体文档（命令salt * sys.doc grains查看文档）")]),s._v("\nsalt -N "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groups")]),s._v(" test.ping\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 组匹配")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如，在master新建/etc/salt/master.d/nodegroups.conf ，yaml格式")]),s._v("\nsalt -C "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'G@os:CentOS or L@Minion'")]),s._v(" test.ping\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复合匹配")]),s._v("\nsalt -I "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key:value'")]),s._v(" test.ping\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Pillar值匹配")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/salt/master设置pillar_roots,数据以yaml保存在Master上")]),s._v("\nsalt -S "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'x.x.x.x/24'")]),s._v(" test.ping\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CIDR匹配")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# x.x.x.x/24是一个指定的CIDR网段")]),s._v("\nsalt -G "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'os:RedHat'")]),s._v(" --batch-size "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("% apache.signal "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("uptime")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 批量处理(按百分比执行)")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v(" -b "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" test.ping\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 批量处理 (一次性执行10台)")]),s._v("\n\nsalt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v(" state.sls apache "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("test")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("True\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# salt模拟执行,不会真的执行,但执行后会有变化的内容会以黄色字体表示出来")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("h2",{attrs:{id:"sls"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sls","aria-hidden":"true"}},[s._v("#")]),s._v(" sls")]),s._v(" "),t("h3",{attrs:{id:"apache"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#apache","aria-hidden":"true"}},[s._v("#")]),s._v(" apache")]),s._v(" "),t("p",[s._v("vim /srv/salt/base/apache.sls")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("Oapache-install:    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装状态的ID声明")]),s._v("\n  pkg.installed:    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pkg为状态模块，installed是pkg模块下的安装方法")]),s._v("\n    - name: httpd   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# installed方法的参数，name是一个特殊的参数，安装的服务为httpd")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注:以上整个状态的意思为：{应该有一个httpd服务，如果有则啥也不干，如果没有则下载一个}")]),s._v("\napache-service:      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务状态的ID")]),s._v("\n  service.running:   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service是状态模块，running是service模块下的启动方法")]),s._v("\n    - name: httpd    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法的目标参数（对哪个目标进行操作）")]),s._v("\n    - enable: True   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目标参数的动作（True为启动）")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v(" salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"主机名*"')]),s._v(" state.sls apache\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行模块")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"tomcat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tomcat","aria-hidden":"true"}},[s._v("#")]),s._v(" tomcat")]),s._v(" "),t("p",[s._v("vim /srv/salt/base/tomcat.sls")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("jdk-install:\n  pkg.installed:         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装jdk")]),s._v("\n    - name: java-1.8.0-openjdk\n\ntomcat-install:\n  file.managed:       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#file模块下的managed的方法（分发文件方法），把master端的文件放到minion端")]),s._v("\n    - name: /usr/local/src/apache-tomcat-8.0.46.tar.gz     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#放到minion端的位置")]),s._v("\n    - source: salt://web/files/apache-tomcat-8.0.46.tar.gz     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在master端的文件")]),s._v("\n    - user: root    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#到minion端的文件的用户组和权限配置")]),s._v("\n    - group: root\n    - mode: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("755")]),s._v("\n  cmd.run:         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在状态里写shell命令，在minion端执行")]),s._v("\n    - name: "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/src "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" zxf apache-tomcat-8.0.46.tar.gz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" apache-tomcat-8.0.46 /usr/local/ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/apache-tomcat-8.0.46 /usr/local/tomcat\n    - unless: "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -L /usr/local/tomcat "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -d /usr/local/apache-tomcat-8.0.46\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v(" state.sls web.tomcat\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行这个多级目录的安装tomcat状态")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"top"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#top","aria-hidden":"true"}},[s._v("#")]),s._v(" top")]),s._v(" "),t("p",[s._v("vim /srv/salt/base/top.sls")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("base:\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 环境名称，表示在base环境对应的目录下")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'client.example.com'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# minion端的ID")]),s._v("\n    - web.tomcat\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在这个minion上执行的状态")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'server.example.com'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# minion端的ID")]),s._v("\n    - web.lamp\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在这个minion上执行的状态")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[s._v("说明")]),s._v(" "),t("p",[s._v("这个高级状态的base 表示当前的高级状态所在的环境\n"),t("code",[s._v("‘client.example.com’")]),s._v(" 为minion的通讯ID\n"),t("code",[s._v("-web.tomcat")]),s._v("          表示执行web目录下的tomcat状态")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("salt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v(" state.highstate\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行这个高级状态")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"client"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#client","aria-hidden":"true"}},[s._v("#")]),s._v(" Client")]),s._v(" "),t("h3",{attrs:{id:"install-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-2","aria-hidden":"true"}},[s._v("#")]),s._v(" Install")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh https://mirrors.tuna.tsinghua.edu.cn/epel/epel-release-latest-7.noarch.rpm\nyum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" salt-minion\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"config-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#config-2","aria-hidden":"true"}},[s._v("#")]),s._v(" Config")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s@#manster:.*@manster: server_ip@'")]),s._v(" /etc/salt/minion\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# master_ip 为 Server 端IP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" master: x.x.x.x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/salt/minion\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用server端IP，默认主机名")]),s._v("\nsystemctl start salt-minion\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 client")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);