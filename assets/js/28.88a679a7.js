(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{313:function(s,a,t){"use strict";t.r(a);var e=t(0),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[s._v("原理")]),s._v(" "),t("p",[t("code",[s._v("zabbix agent")]),s._v(" 安装到"),t("code",[s._v("被监控")]),s._v("的主机上，它负责定期收集各项数据，并发送到zabbix server端，"),t("code",[s._v("zabbix server")]),s._v("将数据存储到数据库中，"),t("code",[s._v("zabbix web")]),s._v("根据数据在前端进行展现和绘图。这里agent收集数据分为 "),t("code",[s._v("主动")]),s._v(" 和"),t("code",[s._v("被动")]),s._v(" 两种模式：")]),s._v(" "),t("p",[t("code",[s._v("主动模式")]),s._v("：由Agent主动建立TCP链接并向Server端发送请求,获取主动的监控项列表,并主动将监控项内需要检测的数据提交给server/proxy。")]),s._v(" "),t("p",[t("code",[s._v("被动模式")]),s._v("：由Server建立TCP链接并向Agent端发送请求,获取监控项的数据，agent返回数据。。")]),s._v(" "),t("p",[t("code",[s._v("zabbix proxy")]),s._v("：可选组件，用于分布式监控环境中，zabbix proxy代表server端，完成局部区域内的信息收集，最终统一发往server端。")])]),s._v(" "),t("h2",{attrs:{id:"架构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#架构","aria-hidden":"true"}},[s._v("#")]),s._v(" 架构")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://took-up-up.gitee.io/pic/zabbix.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#server","aria-hidden":"true"}},[s._v("#")]),s._v(" Server")]),s._v(" "),t("h3",{attrs:{id:"install"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install","aria-hidden":"true"}},[s._v("#")]),s._v(" Install")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh http://repo.zabbix.com/zabbix/4.5/rhel/7/SRPMS/zabbix-5.0.0-0.1alpha1.el7.src.rpm\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装yun源")]),s._v("\nhttp://repo.zabbix.com/zabbix/4.5/rhel/7/x86_64/\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或 选择版本下载")]),s._v("\nyum insatll zabbix-server-mysql zabbix-get -y\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装服务端")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"config"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#config","aria-hidden":"true"}},[s._v("#")]),s._v(" Config")]),s._v(" "),t("p",[t("strong",[s._v("初始化数据表")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -qa zabbix-server-mysql\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 找到create.sql.gz")]),s._v("\ngunzip create.sql.gz\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压得到zabbix数据表")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#新建zabbix数据库并导入表")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" create databases zabbix charset "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf8'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" grant all "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" zabbix.* to zabbix@"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" identified by "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxx'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" flush privileges"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use zabbix"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /xx/create.sql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show tables"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[t("strong",[s._v("修改服务端配置文件")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/zabbix/zabbix_server.conf\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ListenPort")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10051")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务端监听端口")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SourceIP")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过SourceIP参数可以指定服务端的源IP，当server端有多个IP地址时，我们可以指定服务端使用固定的IP与agent端进行通讯，为了安全起见，agent端会基于IP进行一定的访问控制，也就是说agent端只允许指定的IP以server端的身份采集被监控主机的数据，如果IP不对应，则不允许采集被监控主机的数据，所以，当server端有多个IP时，我们可以通过SourceIP参数，指定server端通过哪个IP采集被监控主机的数据。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LogType")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("file\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过LogType参数，可以指定通过哪种方式记录日志，此参数可以设置为三种值，system、file、console,system表示将日志发往syslog，file表示使用指定的文件作为日志文件，console表示将日志发往控制台，默认为file。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LogFile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/zabbix/zabbix_server.log\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当LogType设置为file时，通过LogFile参数设置日志文件位置。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LogFileSize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指明日志文件达到多大时自动滚动，单位为MB，如果设置LogFileSize为50，表示日志大小达到50MB滚动一次，设置为0表示日志文件不会滚动，所有日志保存在一个文件中。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DebugLevel")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志级别")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DBHost")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("localhost\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库IP")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DBUser")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zabbix\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库用户名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DBPassword")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xx\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DBPort")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库端口")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DBSocket")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql/mysql.sock\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库套接字文件")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("h3",{attrs:{id:"run"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#run","aria-hidden":"true"}},[s._v("#")]),s._v(" Run")]),s._v(" "),t("p",[s._v("systemctl start zabbix-server")]),s._v(" "),t("h2",{attrs:{id:"zabbix-web"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#zabbix-web","aria-hidden":"true"}},[s._v("#")]),s._v(" Zabbix Web")]),s._v(" "),t("h3",{attrs:{id:"install-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-2","aria-hidden":"true"}},[s._v("#")]),s._v(" Install")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" zabbix-web zabbix-web-mysql -y\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装zabbix web")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ql zabbix-web\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 找到web路径并移动wen服务器根目录或更改web服务器虚拟主机配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动web服务 访问 ip/zabbix")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 按照以上服务端配置对web进行配置")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"agent"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#agent","aria-hidden":"true"}},[s._v("#")]),s._v(" Agent")]),s._v(" "),t("h3",{attrs:{id:"install-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-3","aria-hidden":"true"}},[s._v("#")]),s._v(" Install")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" zabbix-agent zabbix-sender -y\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装客户端")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"config-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#config-2","aria-hidden":"true"}},[s._v("#")]),s._v(" Config")]),s._v(" "),t("p",[t("strong",[s._v("修改客户端配置文件")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/zabbix/zabbix_agentd.conf\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 被动模式")]),s._v("\nServer：用于指定允许哪台服务器拉取当前服务器的数据，当agent端工作于被动模式，则代表server端会主动拉取agent端数据，那么server端的IP必须与此参数的IP对应，此参数用于实现基于IP的访问控制，如果有多个IP ,可以使用逗号隔开。\nListenIP：用于指定agent端工作于被动模式时所监听的IP地址，默认值为0.0.0.0，表示监听本机的所有IP地址。\nStartAgents：用于指定预生成的agent进程数量。\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主动模式")]),s._v("\nServerActive：此参数用于指定当agent端工作于主动模式时，将信息主动推送到哪台server上，当有多个IP时，可以用逗号隔开。\nHostname：此参数用于指定当前主机的主机名，server端通过此参数对应的主机名识别当前主机。\nRefreshActiveChecks：此参数用于指明agent端每多少秒主动将采集到的数据发往server端。\n\n修改\nserver, serverActive ,hostname 为服务端ip或域名\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"run-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#run-2","aria-hidden":"true"}},[s._v("#")]),s._v(" Run")]),s._v(" "),t("p",[s._v("systemctl start zabbix-agent")])])}),[],!1,null,null,null);a.default=n.exports}}]);